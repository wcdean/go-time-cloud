<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">

<head>




<title>Protect your server against the POODLE SSv3 vulnerability - ALL DISTROS</title>
<style type='text/css'>
div.hacker {
background-color:#666;
border:1px solid #ccc;
color:#fff;
font-family:"Lucida Console","Courier New",Courier,fixed;  font-size:95%;  line-height:160%;  margin-bottom:1.5em;  padding:10px; }

p.note {
 background-color:#ffffe6;
 border:1px solid #eee;
 color:#666;
 padding:.8em 1.6em;
 margin:15px 0;
}

.warning {
 border: 1px #d25100 solid;
 padding: .5em 1em .5em 4em;
 margin: 10px 20px 15px 20px;
 background-image: url('@{help-img-path}/img_warning.gif');
 background-repeat: no-repeat;
 background-position: left top;
 background-color: #ededed;-moz-border-radius:
0.8em;-webkit-border-radius: 0.8em;
 /* -moz-border-bottom-radius: 0;9 */
 -webkit-border-bottom-radius: 0;
 padding-top:14px;
 padding-bottom:15px;
}
</style>


</head>

<body>
 <h1>Protect Your Server from the POODLE SSLv3 Vulnerability </h1>
 <p><strong>Difficulty</strong>: <em><u>1</u></em><br />
        <strong>Time</strong>: <em><u>10 minutes</u></em></p>
    <p>POODLE (Padding Oracle On Downgraded Legacy Encryption) is a vulnerability on servers or clients running the SSLv3 protocol. POODLE allows an attacker to use a man-in-the-middle attack to read any information that is encrypted using SSLv3 protocol. In a man-in-the-middle attack, an attacker intercepts the communication between two unsuspecting victims and may alter the communication between them.    </p>
<p>The best method to mitigate this type of attack is to disable  SSLv3 on your servers and clients. You should also evaluate any servers that might be using  services that rely on the SSL protocol. This article describes the methods to disable SSLv3 on different web servers. </p>
    
    <h2>Disable SSLv3 on Apache</h2>
    <ol>
    <li>You need to edit the Apache configuration in order to disable the SSL v3 protocol. The location of the configuration file varies based on the distribution that your server is running. 
         <ul>
            <li>For Ubuntu or Debian, open the <code>/etc/apache2/mods-available/ssl.conf</code> file.</li>
            <li>For CentOS or Fedora, open the <code>/etc/httpd/conf.d/ssl.conf</code> file.</li> 
        </ul>
    </li>   
    <li>Add the following directive: 
      <div class="hacker"> SSLProtocol All -SSLv2 -SSLv3</div> 
        This directive allows all protocols except SSLv2 and SSLv3. 
     </li>
     <li>Save and exit the file.</li>
     <li>Restart the Apache server for the changes to take effect. 
         <ul>
           <li>Restart a server using Ubuntu or Debian.
           <div class="hacker">sudo service apache2 restart</div></li>
           <li>Restart a server using CentOS or Fedora.
               <div class="hacker">systemctl restart httpd</div></li>
         </ul>
      </li>

    </ol>
    <h2>Disable SSLv3 on Dovecot</h2>
    <ol>
      <li>
            If you are running Dovecot versions 2.1 and later, add the following directive in the <code>  /etc/dovecot/conf.d/10-ssl.conf</code> configuration file.
            <div class="hacker">ssl_protocols = !SSLv3 !SSLv2</div>
        </li>
        <li>
            If you are running versions of Dovecot earlier than 2.1, change the <code>ssl_cipher_list</code> to disable SSLv3.
            <div class="hacker">ssl_cipher_list = ALL:!LOW:!SSLv2:!EXP:!aNULL:!SSLv3</div>
        </li>
        <li>
            Restart the service for the changes to take effect.
            <div class="hacker">sudo service Dovecot restart</div>
        </li>

    </ol>

    <h2>Disable SSLv3 on HAProxy</h2>
    <ol>
        <li>If you are running HAProxy versions 1.5 or later, you need to edit the <code> /etc/haproxy/haproxy.cfg</code> configuration file: Add or modify the following directive in the <code>frontend name</code> section:
            <div class="hacker">bind public_ip:443 ssl crt /path/to/certs no-sslv3</div>
            The bind class specifies the IP address and the port.
      </li>

        <li>
            Restart the service for the changes to take effect.
            <div class="hacker">sudo service haproxy restart</div>
        </li>
</ol>
    <h2>Disable SSLv3 on Nginx</h2>
    <ol>
        <li>If you are running Nginx on your server, add a directive in the Nginx configuration file, <code>/etc/nginx/nginx.conf</code>.
          <div class="hacker">ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</div>
        </li>
        <li>
            Restart the Nginx server for the changes to take effect.
            <div class="hacker">sudo service nginx restart</div>
        </li>       

    </ol>
<h2>Disabling SSLv3 on OpenVPN</h2>
<p>Because OpenVPN does not allow SSLv3, it's not vulnerable to the POODLE attack.</p>

    <h2>Disable SSLv3 on Postfix</h2>
    <ol>
      <li>
            If you are running Postfix in mandatory SSL mode, then you need to modify the configuration. Open the <code>/etc/postfix/main.cf</code> to add the following directive under the <code># TLS parameters</code> section:
            <div class="hacker">smtpd_tls_mandatory_protocols=!SSLv2,!SSLv3</div>
        </li>
        <li>
        Restart the Postfix server for the changes to take effect.
        <div class="hacker">sudo service postfix restart</div>
        </li> 
    </ol>
    <p class="note">If you are running Postfix in the opportunistic SSL mode, you don't need to change anything because the encryption is not enforced in this mode.</p>


<h2>Conclusion</h2>
<p>POODLE not only affects server-side applications but also any system or services dependent on the SSLv3 protocol. Make sure that you protect yourself adequately whether in a consumer role or a service provider role. </p>
</body>
</html>