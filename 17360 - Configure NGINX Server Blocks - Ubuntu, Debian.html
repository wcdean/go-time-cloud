<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<head>
<title>Configure NGINX Server Blocks - Ubuntu</title>
<style>
div.hacker {
background-color:#666;
border:1px solid #ccc;
color:#fff;
font-family:"Lucida Console","Courier New",Courier,fixed;  font-size:95%;  line-height:160%;  margin-bottom:1.5em;  padding:10px; }
p.note {
 background-color:#ffffe6;
 border:1px solid #eee;
 color:#666;
 padding:.8em 1.6em;
 margin:15px 0;
}
.warning {
 border: 1px #d25100 solid;
 padding: .5em 1em .5em 4em;
 margin: 10px 20px 15px 20px;
 background-image: url('@{help-img-path}/img_warning.gif');
 background-repeat: no-repeat;
 background-position: left top;
 background-color: #ededed;-moz-border-radius:
0.8em;-webkit-border-radius: 0.8em;
 /* -moz-border-bottom-radius: 0;9 */
 -webkit-border-bottom-radius: 0;
 padding-top:14px;
 padding-bottom:15px;
}
    </style>
</head>
<body>
<h1>Configure NGINX Server Blocks - Ubuntu, Debian</h1>    
    <br/><strong>Difficulty</strong>: <em><u>2</u></em><br/>
        <strong>Time</strong>: <em><u>Time value</u></em>
    <br/>
<p>NGINX is one of the most popular web server solutions in the industry. Considered to be a competitor to the traditional <a href="http://apache.org/">Apache web server</a>, NGINX is known for being faster and easier to scale than other web servers.</p>
<p>Unlike Apache, which uses <a href="/article/17336?prog_id=PROG_ID" target="_blank">Virtual Hosts</a> to manage individual sites and domains, NGINX uses server blocks. Server blocks let you host multiple sites with different domains on the same server. This guide will cover how to set up server blocks for your domains and subdomains on your Ubuntu or Debian server.</p>
<h2>Prerequisites</h2>
<ol>
  <li>You must have an Ubuntu or Debian server with NGINX installed. If you do not have NGINX installed, follow the NGINX install steps in the LEMP stack guide for your <a href="/article/17347?prog_id=PROG_ID" target="_blank">Ubuntu</a> or <a href="/article/17351?prog_id=PROG_ID" target="_blank">Debian</a> server.
  </li>
  <li>Log in to your server with a user that has <code>sudo</code> privileges. If you have a GoDaddy Cloud server, you will already have one by default.</li>
  <li><a href="/article/19116?prog_id=PROG_ID" target="_blank">Point a domain or subdomain to your server</a>. If you don't want to use a real domain yet, you can <a href="/article/3354?prog_id=PROG_ID" target="_blank">edit your hosts file</a> to test your configuration.</li>
</ol>
<h2>Create directory structures and permissions</h2>
<p>Ubuntu uses <code>/usr/share/nginx/html</code> as the base root for the NGINX server overall. Debian uses <code>/usr/share/nginx/www</code>. You will create directories in <code>/usr/share/nginx/</code> for each site you want to host.</p>
<ol>
  <li>Create a directory for your domain.
    <div class="hacker">sudo mkdir -p /usr/share/nginx/<em><u>coolexample.com</u></em></div>
  </li>
  <li>Give this directory the correct permissions ownership for the NGINX user.
    <div class="hacker">sudo chown -R www-data:www-data /usr/share/nginx/<em><u>coolexample.com</u></em><br \>
    sudo chmod -R 755 /usr/share/nginx/<em><u>coolexample.com</u></em>
    </div>
    You now have a directory for your site. Repeat this for any more sites that you want to host.
  </li>
  <li>Create a test index file</h2>
    <div class="hacker">sudo vim /usr/share/nginx/<em><u>coolexample.com</u></em>/index.html</div>
  </li>
  <li>Paste this example HTML file in the editor. You can use your own text and domain as you see fit.
    <div class="hacker">
    <!--pre--><xmp><html>
      <head>
          <title>coolexample.com</title>
        </head>
        <body>
          <h1>Hooray! NGINX is properly serving on <em>coolexample.com</em>!</h1>
        </body>
      </html>
    </xmp><!--/pre--></div>
  </li>
  <li>Save and close the file
  </li>
</ol>
<h2>Create the NGINX server block</h2>
<p>Now for the important part. You will create the file and directory for the NGINX server block information. This guide will set this up in a way that will make it simple to add more sites in the future.</p>
  <ol>
    <li>Create a new file to use as a server block template. You will use this template for creating sites in the future.
      <div class="hacker">sudo vim /etc/nginx/sites-available/template</div>
    </li>
    <li>Inside this file, paste the following content. This has the basics for your NGINX server block.
      <div class="hacker">
        <pre>
          server {
              listen       80;
              server_name yoursitehere  www.yoursitehere;
            location / {
              root   /usr/share/nginx/yoursitehere;
              index index.php index.html index.html;
                }
          }
        </pre></div>
    </li>
    <li>Save and close the file.</li>
    <li>You now have a template file you can use for creating future server blocks. Copy this for your new server block.
      <div class="hacker">sudo cp /etc/nginx/sites-available/template /etc/nginx/sites-available/<em><u>coolexample.com</u></em>
    </li>
    <li>In this file, you need to replace <strong>yoursitehere</strong> with the domain you are setting up. There are a few ways to do this:
      <ul>
        <li>Open the file in a text editor, and manually edit the paths. This is useful if you have to make additional edits to the configuration file.
          <div class="hacker">sudo vim /etc/nginx/sites-available/<em><u>coolexample.com</u></em>
        </li>
        <li>Use this <code>sed</code> command. This will automatically replace all instances of <strong>yoursitehere</strong> with the domain of your choice inside the configuration file.
          <div class="hacker">sudo sed -i 's/yoursitehere/<em><u>coolexample.com</u></em>/g' /etc/nginx/sites-available/<em><u>coolexample.com</u></em>
          </div>
        </li>
      </ul>
    </li>
    <li>Add a symbolic link in the <code>sites-enabled</code> directory to enable this server block.
      <div class="hacker">sudo ln -s /etc/nginx/sites-available/<em><u>coolexample.com</u></em> /etc/nginx/sites-enabled/<em><u>coolexample.com</u></em>
    </div></li>
    <li>Restart NGINX to confirm all your changes.
      <div class="hacker">sudo service nginx restart</div>
        <p class="note">If you get an error when restarting NGINX, it is likely that you have not properly changed the server block files in the <code>sites-available</code> directory. Make sure that you have all your <code>{ }</code> brackets closed and that all directives end in a semicolon.</p>
    </li>
  </ol>
<p>You should now be able to navigate to your site in a browser, and see the index file you created.</p>
<h2>Conclusion</h2>
<p> You are now ready to upload your site or install your application to your new site directory, and get your site up and running on NGINX. You can repeat this guide for any additional sites you want to host on your server. For additional NGINX server configuration options, check out the <a href="http://nginx.org/en/docs/beginners_guide.html">Official NGINX documentation portal</a>.</p>