<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">

<head>


<title>Configure Apache Virtual Hosts - CentOS 6</title>
<style type="text/css">
div.hacker {
background-color:#666;
border:1px solid #ccc;
color:#fff;
font-family:"Lucida Console","Courier New",Courier,fixed;  font-size:95%;  line-height:160%;  margin-bottom:1.5em;  padding:10px; }

p.note {
 background-color:#ffffe6;
 border:1px solid #eee;
 color:#666;
 padding:.8em 1.6em;
 margin:15px 0;
}

.warning {
 border: 1px #d25100 solid;
 padding: .5em 1em .5em 4em;
 margin: 10px 20px 15px 20px;
 background-image: url('@{help-img-path}/img_warning.gif');
 background-repeat: no-repeat;
 background-position: left top;
 background-color: #ededed;-moz-border-radius:
0.8em;-webkit-border-radius: 0.8em;
 /* -moz-border-bottom-radius: 0;9 */
 -webkit-border-bottom-radius: 0;
 padding-top:14px;
 padding-bottom:15px;
}
</style>



</head>

<body>
<p>Configuring Apache Virtual Hosts for CentOS 6.</p>
    <h1>Configure Apache Virtual Hosts - CentOS 6</h1>
    
   <p><strong>Difficulty</strong>: <em><u>2</u></em><br />
        <strong>Time</strong>: <em><u>30 minutes</u></em></p>
    
<p>Want to host multiple websites? Using Apache? Great. This article will show you how to do exactly that using Apache’s “virtual hosts” – and it’ll let you do it without needing any additional IP addresses.</p>

<p>In Apache, every site is handled by a virtual host which points incoming <code>http</code> traffic to a particular directory (i.e. the root directory of the website for the domain in the request). By default, Apache only creates one virtual host but you can configure more – as many as your server can handle.</p>

<p>Throughout this article, we'll use an example domain – <em><u>coolexample.com</u></em> – but you should replace it with the domain name or subdomain you want to host on your server.</p>
    
<h2>Install the Apache web server</h2>
<p>To get Apache on your server, you can either <a href="/article/17342?prog_id=PROG_ID">install it as part of a LAMP stack</a>, or you can install Apache by itself:</p>

<ol>
    <li>Install Apache by running the <code>yum</code> command.<br />
          <div class="hacker">sudo yum install httpd</div></li>
    <li>Start up Apache so that the httpd service will start automatically on a reboot:
        <div class="hacker">sudo service httpd start</div></li>
</ol>
   
<h2>Set up the virtual host</h2>
<ol>
    <li>Create the virtual directories for your domain:
        <div class="hacker">sudo mkdir -p /var/www/<em><u>coolexample.com</u></em>/public_html</div></li>
    <li>Set up ownership and grant permissions. Change the ownership from the <code>root</code> user to a regular user using <code>chown</code>. This way, regular users can modify files in your web directories:
        <div class="hacker">sudo chown -R apache:apache /var/www/<em><u>coolexample.com</u></em>/public_html</div></li>
    <li>Set read permissions to the Apache web root <code>/var/www </code> directory to enable access to the files from that directory. Modify permissions so that the general web directory has read access.
        <div class="hacker">sudo chmod -R 755 /var/www/</div></li>
</ol>
    
<h2>Create a sample page for your virtual host</h2>
    
<ol>
    <li>Create a sample page for your virtual host:
        <div class="hacker">sudo vim /var/www/<em><u>coolexample.com</u></em>/public_html/index.html</div></li>
    <li>Add some content to the file:
        <div class="hacker"><pre>&lt;html&gt; 
    &lt;head&gt; 
    &lt;title&gt;Welcome to my site!&lt;/title&gt; 
    &lt;/head&gt; 
    &lt;body&gt; 
    &lt;h1&gt;Hooray! Your virtual host is working!&lt;/h1&gt; 
    &lt;/body&gt; 
&lt;/html&gt;</pre></div></li>
    <li>Save and close the file:
      <div class="hacker">:wq!</div></li>
</ol>
    
    
<h2>Modify your Apache configuration file</h2>
<p>Edit the main configuration file so that Apache will look for a virtual host.</p>

<ol>
    <li>Open the Apache config file:
        <div class="hacker">sudo vim /etc/httpd/conf/httpd.conf</div></li>
    <li>Uncomment <code>NameVirtualHost</code> so that it looks like this:
          <div class="hacker">NameVirtualHost *:80</div></li>
    <li>At the very end of the file, find the section beginning with <code>&lt;VirtualHost *:80&gt;</code> and make the following changes to this part:
        <ul>
            <li>Starting with the first line <code>&lt;VirtualHost *:80&gt;</code>, uncomment the whole section, ending with <code>&lt;/VirtualHost&gt;</code>. </li>
            <li>Point <code>DocumentRoot</code> to your domain and the directory that holds it. In our case, that would be <code>/var/www/<em><u>coolexample.com</u></em>/public_html</code>. So the line will look like this:
                <div class="hacker">DocumentRoot /var/www/<em><u>coolexample.com</u></em>/public_html</div></li>
            <li>Point <code>ServerName</code> to your domain with the www.</li>
            <li>Make sure that your hostname has a valid DNS record, so that the www version of your domain works. In our case, that would be <em><u>www.coolexample.com</u></em></li>
            <li>Point <code>ServerAlias</code> to other variations of your domain, such as the domain without the www.</li>
        </ul>

    <p>Here's what the whole section could look like after your changes:</p>
    <div class="hacker"><pre>
    &lt;VirtualHost *:80&gt;
    ServerAdmin webmaster@coolexample.com
    DocumentRoot /var/www/<em><u>coolexample.com</u></em>/public_html
    ServerName <em><u>www.coolexample.com</u></em> 
    ServerAlias <em><u>coolexample.com</u></em> 
    ServerName <em><u>www.coolexample.com</u></em>     
    ErrorLog /var/www/<em><u>coolexample.com</u></em>/error.log 
    CustomLog /var/www/<em><u>coolexample.com</u></em>/requests.log combined 
    &lt;/VirtualHost&gt </pre> </div>

    <p class="note">Note that the other lines (<code>ServerAdmin</code>, <code>ErrorLog</code>, and <code>CustomLog</code>) are not required to set up your virtual host. We've filled them out for this example.</p></li>

    <li>Save and close the file:
      <div class="hacker">:wq!</div></li>
    <li>Restart Apache:
        <div class="hacker">sudo service httpd restart</div></li>
</ol>

<p>You may see the following error, which you can disregard. This message is just a warning, and your virtual hosts will work:</p>
        <div class="hacker">Could not reliably determine the server's fully qualified domain name, using 127.0.0.1 for ServerName</div>
 
<h2>Point your domain name to your server</h2>
<p>If your domain name isn't currently loading another website, you should point it to your server to test your new config.</p>

<p>How you do this depends on where your domain name is registered and whose server you're using:</p>

<style>
table {border-collapse: collapse; color: #333; margin: 1.2rem 0;}

tr:nth-child(odd) {background-color: #f7f7f7;}

tr:nth-child(1) {background-color:#ddd;}

th{border-right: 1px solid #ddd; padding: 5px; text-align:left;}

td{border: 1px solid #b2b2b2;padding: 5px;vertical-align:top;}
</style>
<table>
    <tr>
        <th>Domain registered?</th>
        <th>Server hosted?</th>
        <th>Do this...</th>
    </tr>
    <tr>
        <td>COMPANY_NAME</td>
        <td>COMPANY_NAME</td>
        <td><article id="19116" /></td>
    </tr>
    <tr>
        <td>Another company</td>
        <td>COMPANY_NAME</td>
        <td><article id="19051" /> and then update your domain name's primary ("@") A record.</td> 
    </tr>
    <tr>
        <td>COMPANY_NAME</td>
        <td>Another company</td>
        <td>Find your server's IP address, and then <a href="/article/20134?prog_id=PROG_ID">change your domain's IP address to use it</a>.</td>
    </tr>
    <tr>
        <td>Another company</td>
        <td>Another company</td>
        <td>Find your server's IP address, and then change your domain's IP address to use it.</td>
    </tr>
</table>

<p>Changes to your domain can take up to 48 hours to display across the internet. However, once they do, you can visit your domain name and view the test page you created earlier!</p>
      

<h2>Adding additional virtual hosts</h2>

<p>Repeat the above steps to create more virtual hosts. Be sure to create a new document root with your domain name each time.  </p>


<p>In your Apache config file, copy and paste the new Virtual Host information. So, for example, if you were adding coolexample.net as a second host, it could look like this:</p>
     <div class="hacker"><pre>
   &lt;VirtualHost *:80&gt;
    ServerAdmin webmaster@coolexample.com
    DocumentRoot /var/www/<em><u>coolexample.com</u></em>/public_html 
    ServerName <em><u>www.coolexample.com</u></em> 
    ServerAlias <em><u>coolexample.com</u></em>
    ServerName <em><u>www.coolexample.com</u></em>     
    ErrorLog /var/www/<em><u>coolexample.com</u></em>/error.log 
    CustomLog /var/www/<em><u>coolexample.com</u></em>/requests.log combined 
    &lt;/VirtualHost&gt; 

   &lt;VirtualHost *:80&gt;
    ServerAdmin webmaster@coolexample.net
    DocumentRoot <em><u>/var/www/coolexample.net/public_html</u></em> 
    ServerName <em><u>www.coolexample.net</u></em> 
    ServerAlias <em><u>coolexample.net</u></em> 
    ServerName <em><u>www.coolexample.net</u></em>     
    ErrorLog /var/www/coolexample.net/error.log 
    CustomLog /var/www/coolexample.net/requests.log combined 
    &lt;/VirtualHost&gt; 
  </pre></div>

<h2>Next steps</h2>
<p>Congratulations! You now have a single server handling a site with its own domain. Again, remember that you can add additional virtual hosts since there is no limit on the number of domain names Apache can handle.</p>

  </body>
</html>